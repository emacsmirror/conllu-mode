# -*- mode:org -*-
#+TITLE: emacs mode for CoNLL-U files

[[https://melpa.org/#/conllu-mode][file:https://melpa.org/packages/conllu-mode-badge.svg]]

this mode provides simple utilities for editing and viewing CoNLL-U
files.

you can watch the following demo for an idea of what it can do:

[[https://asciinema.org/a/vO51IVyAeKBF1uSB1ogzCXcCb][file:static/demo.png]]

* default key bindings
| key binding | description                                                                                          |
|-------------+------------------------------------------------------------------------------------------------------|
| =C-c C-a=   | align columns (inserts no real whitespace) in the selected region (defaults to the current sentence) |
| =C-c C-u=   | unalign columns in the selected region (defaults to current sentence)                                |
| =C-c C-c=   | clear field at point, placing =_= as its value                                                       |
| =C-c C-e=   | edit field at point interactively                                                                    |
| =C-c C-l=   | insert empty token line at point or at next line (can be called with prefix argument for more lines) |
| =M-n=       | unalign current sentence, go to the next one, and align it                                           |
| =M-p=       | unalign current sentence, go to the previous one, and align it                                       |
| =C-c N=     | move to field number N in a token line (=C-c 0= moves to field number 10, i.e. MISC)                 |
| =C-c C-h=   | move point to head token of present token                                                            |

* features
- highlighting comments, and =upostag= and =deprel= fields
- truncate lines by default
- show newline and tab characters using =whitespace.el=
- aligning and unaligning column fields
- jumping to next or previous sentence
- jump to the token at point's =head=
- flycheck CoNLL-U buffers

* flycheck
** setup
to be able to flycheck CoNLL-U buffers you need to:

- obtain the =validate.py= script from the [[https://github.com/universaldependencies/tools][UD-tools]] repository (make
  sure you clone/download the whole repo, because the script depends
  on data and configuration files in there).
- set the =conllu-flycheck-validate.py-path= variable to the filepath
  of the =validate.py= script. you can use =M-x customize-variable
  conllu-flycheck-validate.py-path= for this.

** use
you can use the normal flycheck keybindings (here's [[https://www.masteringemacs.org/article/spotlight-flycheck-a-flymake-replacement][a nice
summary]]). note that the =validate.py= demands a two-letter language
code to do its validation; =conllu-mode= infers this from the file
name, assuming it follows UD filename convention of starting with such
a language code (as in =pt_bosque-ud-test.conllu=). if your file
doesn't start with a language code, flycheck will invoke the script
with the default value of =ud=, which might throw spurious errors.

* missing
  if you'd like to have a feature implemented, you should file at
  ticket at the [[https://github.com/odanoburu/conllu-mode/issues][issue tracker]]. here is our wishlist of what we would
  like to implement in the future:

- hiding columns
- call a parser to create CoNLL-U output from a sentence
- call external visualization tool
# - in a sentence, jump to token that has a given index
# - in sentence, jump to next token that has a given =upostag=
# - in sentence, jump to next token that has a given =deprel=
# are the above three really interesting? emacs can do better with
# incremental search and other functionality
- ...
  
* installation
you may install the latest versions from MELPA, or proceed to a manual
installation:
** MELPA
   [[https://melpa.org/#/getting-started][set MELPA up]] if you haven't already and then do:
   : M-x package-install RET conllu-mode
** manual installation
   first you must install the dependencies: assuming you have a
   standard Emacs distribution, you need to install [[https://github.com/magnars/s.el][s]] and [[https://github.com/flycheck/flycheck][flycheck]].

   after having installed the dependencies, clone the repo, as in:
   #+BEGIN_SRC sh
     $ cd ~/some/path/
     $ git clone https://github.com/odanoburu/conllu-mode
   #+END_SRC
   make sure that the repository is in the emacs load path and that
   the autoloads are properly set with
   #+BEGIN_SRC elisp
     (add-to-list 'load-path "~/some/path/conllu-mode")
     (autoload 'conllu-mode "conllu-mode" "Major mode for editing CoNLL-U files." t)
     (add-to-list 'auto-mode-alist '("\\.conllu\\'" . conllu-mode))
   #+END_SRC
   in your =.emacs=.

* contributions
  yes, please! even comments from experienced elispers are
  welcome. just send an email or open an issue -- if you'd like a
  suggestion on what to work on, take a look at the open issues or at
  the missing features (above).
